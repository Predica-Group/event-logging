{
  "$schema" : "http://json-schema.org/draft-04/schema#",
  "title" : "Events",
  "type" : "object",
  "additionalProperties" : false,
  "properties" : {
    "event" : {
      "type" : "array",
      "items" : {
        "$ref" : "#/definitions/Event"
      }
    },
    "version" : {
      "type" : "string"
    }
  },
  "definitions" : {
    "Event" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "meta" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/AnyContent"
          }
        },
        "classification" : {
          "$ref" : "#/definitions/Classification"
        },
        "eventTime" : {
          "$ref" : "#/definitions/EventTime"
        },
        "eventSource" : {
          "$ref" : "#/definitions/EventSource"
        },
        "eventDetail" : {
          "$ref" : "#/definitions/EventDetail"
        },
        "eventChain" : {
          "$ref" : "#/definitions/EventChain"
        },
        "data" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Data"
          }
        }
      }
    },
    "AnyContent" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "content" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Object"
          }
        },
        "contentType" : {
          "type" : "string"
        },
        "version" : {
          "type" : "string"
        }
      }
    },
    "Object" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : { }
    },
    "Classification" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "text" : {
          "type" : "string"
        },
        "originator" : {
          "$ref" : "#/definitions/Organisation"
        },
        "custodian" : {
          "$ref" : "#/definitions/Organisation"
        },
        "classification" : {
          "type" : "string"
        },
        "descriptors" : {
          "$ref" : "#/definitions/Descriptors"
        },
        "orGroups" : {
          "$ref" : "#/definitions/AccessControlGroups"
        },
        "andGroups" : {
          "$ref" : "#/definitions/AccessControlGroups"
        },
        "permittedNationalities" : {
          "$ref" : "#/definitions/PermittedNationalities"
        },
        "permittedOrganisations" : {
          "$ref" : "#/definitions/PermittedOrganisations"
        },
        "disseminationControls" : {
          "$ref" : "#/definitions/DisseminationControls"
        },
        "disposition" : {
          "$ref" : "#/definitions/Disposition"
        },
        "data" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Data"
          }
        }
      }
    },
    "Organisation" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "country" : {
          "type" : "string"
        },
        "organisation" : {
          "type" : "string"
        }
      }
    },
    "Descriptors" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "descriptor" : {
          "type" : "array",
          "items" : {
            "type" : "string"
          }
        }
      }
    },
    "AccessControlGroups" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "accessControlGroups" : {
          "type" : "array",
          "items" : {
            "type" : "string"
          }
        }
      }
    },
    "PermittedNationalities" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "nationalities" : {
          "type" : "array",
          "items" : {
            "type" : "string"
          }
        }
      }
    },
    "PermittedOrganisations" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "permittedOrganisation" : {
          "$ref" : "#/definitions/Organisation"
        }
      }
    },
    "DisseminationControls" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "disseminationControl" : {
          "type" : "array",
          "items" : {
            "type" : "string"
          }
        }
      }
    },
    "Disposition" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "date" : {
          "type" : "integer",
          "format" : "utc-millisec"
        },
        "process" : {
          "type" : "string"
        }
      }
    },
    "Data" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "data" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Data"
          }
        },
        "name" : {
          "type" : "string"
        },
        "value" : {
          "type" : "string"
        }
      }
    },
    "EventTime" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "timeCreated" : {
          "type" : "integer",
          "format" : "utc-millisec"
        },
        "timeSource" : {
          "$ref" : "#/definitions/Device"
        }
      }
    },
    "Device" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "id" : {
          "type" : "string"
        },
        "name" : {
          "type" : "string"
        },
        "classification" : {
          "$ref" : "#/definitions/Classification"
        },
        "hostName" : {
          "type" : "string"
        },
        "port" : {
          "type" : "integer"
        },
        "location" : {
          "$ref" : "#/definitions/Location"
        },
        "data" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Data"
          }
        },
        "ipaddress" : {
          "type" : "string"
        },
        "macaddress" : {
          "type" : "string"
        }
      }
    },
    "Location" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "country" : {
          "type" : "string"
        },
        "state" : {
          "type" : "string"
        },
        "city" : {
          "type" : "string"
        },
        "town" : {
          "type" : "string"
        },
        "site" : {
          "type" : "string"
        },
        "building" : {
          "type" : "string"
        },
        "floor" : {
          "type" : "integer"
        },
        "room" : {
          "type" : "string"
        },
        "desk" : {
          "type" : "string"
        },
        "rack" : {
          "type" : "string"
        },
        "position" : {
          "type" : "string"
        },
        "timeZoneName" : {
          "type" : "string"
        },
        "coordinates" : {
          "$ref" : "#/definitions/Coordinates"
        },
        "accessZone" : {
          "type" : "string"
        }
      }
    },
    "Coordinates" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "latitude" : {
          "type" : "number"
        },
        "longitude" : {
          "type" : "number"
        }
      }
    },
    "EventSource" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "eventId" : {
          "type" : "string"
        },
        "sessionId" : {
          "type" : "string"
        },
        "system" : {
          "$ref" : "#/definitions/SystemDetail"
        },
        "generator" : {
          "type" : "string"
        },
        "device" : {
          "$ref" : "#/definitions/Device"
        },
        "client" : {
          "$ref" : "#/definitions/Device"
        },
        "server" : {
          "$ref" : "#/definitions/Device"
        },
        "door" : {
          "$ref" : "#/definitions/Door"
        },
        "user" : {
          "$ref" : "#/definitions/User"
        },
        "runAs" : {
          "$ref" : "#/definitions/User"
        },
        "interactive" : {
          "type" : "boolean"
        },
        "data" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Data"
          }
        }
      }
    },
    "SystemDetail" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "name" : {
          "type" : "string"
        },
        "description" : {
          "type" : "string"
        },
        "classification" : {
          "$ref" : "#/definitions/Classification"
        },
        "environment" : {
          "type" : "string"
        },
        "organisation" : {
          "type" : "string"
        },
        "version" : {
          "type" : "string"
        },
        "tags" : {
          "$ref" : "#/definitions/Tags"
        }
      }
    },
    "Tags" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "tag" : {
          "type" : "array",
          "items" : {
            "type" : "string"
          }
        }
      }
    },
    "Door" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "name" : {
          "type" : "string"
        },
        "description" : {
          "type" : "string"
        },
        "location" : {
          "$ref" : "#/definitions/Location"
        },
        "singleEntry" : {
          "type" : "boolean"
        },
        "removeAll" : {
          "type" : "boolean"
        },
        "addAccess" : {
          "$ref" : "#/definitions/AddAccess"
        }
      }
    },
    "AddAccess" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "accessZones" : {
          "type" : "array",
          "items" : {
            "type" : "string"
          }
        }
      }
    },
    "User" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "meta" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/AnyContent"
          }
        },
        "type" : {
          "type" : "string"
        },
        "id" : {
          "type" : "string"
        },
        "name" : {
          "type" : "string"
        },
        "description" : {
          "type" : "string"
        },
        "classification" : {
          "$ref" : "#/definitions/Classification"
        },
        "state" : {
          "type" : "string"
        },
        "groups" : {
          "$ref" : "#/definitions/Groups"
        },
        "permissions" : {
          "$ref" : "#/definitions/Permissions"
        },
        "tags" : {
          "$ref" : "#/definitions/MetaDataTags"
        },
        "domain" : {
          "type" : "string"
        },
        "emailAddress" : {
          "type" : "string"
        },
        "userDetails" : {
          "$ref" : "#/definitions/UserDetails"
        },
        "data" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Data"
          }
        }
      }
    },
    "Groups" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "groups" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Group"
          }
        }
      }
    },
    "Group" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "meta" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/AnyContent"
          }
        },
        "type" : {
          "type" : "string"
        },
        "id" : {
          "type" : "string"
        },
        "name" : {
          "type" : "string"
        },
        "description" : {
          "type" : "string"
        },
        "classification" : {
          "$ref" : "#/definitions/Classification"
        },
        "state" : {
          "type" : "string"
        },
        "groups" : {
          "$ref" : "#/definitions/Groups"
        },
        "permissions" : {
          "$ref" : "#/definitions/Permissions"
        },
        "tags" : {
          "$ref" : "#/definitions/MetaDataTags"
        },
        "data" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Data"
          }
        }
      }
    },
    "Permissions" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "permissions" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Permission"
          }
        }
      }
    },
    "Permission" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "permissionEntity" : {
          "$ref" : "#/definitions/PermissionEntity"
        },
        "allowAttributes" : {
          "type" : "array",
          "items" : {
            "type" : "string",
            "enum" : [ "AUTHOR", "OWNER", "READ", "WRITE", "EXECUTE" ]
          }
        },
        "denyAttributes" : {
          "type" : "array",
          "items" : {
            "type" : "string",
            "enum" : [ "AUTHOR", "OWNER", "READ", "WRITE", "EXECUTE" ]
          }
        }
      }
    },
    "PermissionEntity" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : { }
    },
    "MetaDataTags" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "tags" : {
          "type" : "array",
          "items" : {
            "type" : "string"
          }
        }
      }
    },
    "UserDetails" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : { }
    },
    "EventDetail" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "typeId" : {
          "type" : "string"
        },
        "description" : {
          "type" : "string"
        },
        "purpose" : {
          "$ref" : "#/definitions/Purpose"
        },
        "eventAction" : {
          "$ref" : "#/definitions/EventAction"
        }
      }
    },
    "Purpose" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "classification" : {
          "$ref" : "#/definitions/Classification"
        },
        "subject" : {
          "type" : "string"
        },
        "stakeholders" : {
          "type" : "string"
        },
        "justification" : {
          "type" : "string"
        },
        "expectedOutcome" : {
          "type" : "string"
        },
        "authorisations" : {
          "$ref" : "#/definitions/Authorisations"
        },
        "data" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Data"
          }
        }
      }
    },
    "Authorisations" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "auth" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Auth"
          }
        }
      }
    },
    "Auth" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "refNo" : {
          "type" : "string"
        },
        "detail" : {
          "type" : "string"
        }
      }
    },
    "EventAction" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : { }
    },
    "EventChain" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "activity" : {
          "$ref" : "#/definitions/Activity"
        }
      }
    },
    "Activity" : {
      "type" : "object",
      "additionalProperties" : false,
      "properties" : {
        "id" : {
          "type" : "string"
        },
        "name" : {
          "type" : "string"
        },
        "parent" : {
          "$ref" : "#/definitions/Activity"
        }
      }
    }
  }
}